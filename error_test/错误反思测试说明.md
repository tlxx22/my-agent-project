# é”™è¯¯åæ€æµ‹è¯•å¥—ä»¶è¯´æ˜

## æ¦‚è¿°

æœ¬æµ‹è¯•å¥—ä»¶åŒ…å«8ä¸ªä¸åŒçš„é”™è¯¯åœºæ™¯æµ‹è¯•ï¼Œç”¨äºéªŒè¯æ™ºèƒ½ä½“çš„LLMé”™è¯¯åæ€å’Œå†³ç­–èƒ½åŠ›ã€‚æ¯ä¸ªæµ‹è¯•éƒ½ä¼šæ¨¡æ‹Ÿç‰¹å®šçš„é”™è¯¯æƒ…å†µï¼Œå¹¶è§¦å‘`enhanced_error_handler`è¿›è¡Œæ™ºèƒ½åˆ†æå’Œå†³ç­–ã€‚

## æµ‹è¯•æ–‡ä»¶åˆ—è¡¨

| æ–‡ä»¶å | é”™è¯¯åœºæ™¯ | é”™è¯¯èŠ‚ç‚¹ | é¢„æœŸå†³ç­– |
|--------|----------|----------|----------|
| `test_error_reflection_1_file_not_found.py` | æ–‡ä»¶ä¸å­˜åœ¨é”™è¯¯ | `enter_upload_file` | retry/terminate |
| `test_error_reflection_2_file_format.py` | æ–‡ä»¶æ ¼å¼é”™è¯¯ | `enter_upload_file` | terminate |
| `test_error_reflection_3_table_extraction.py` | è¡¨æ ¼æå–å¤±è´¥ | `extract_excel_tables` | retry/terminate |
| `test_error_reflection_4_data_parsing.py` | æ•°æ®è§£æé”™è¯¯ | `parse_instrument_table` | skip/terminate |
| `test_error_reflection_5_classification.py` | åˆ†ç±»å¤±è´¥é”™è¯¯ | `classify_instrument_type` | retry/skip |
| `test_error_reflection_6_statistics.py` | ç»Ÿè®¡è®¡ç®—é”™è¯¯ | `summarize_statistics` | retry/skip |
| `test_error_reflection_7_standards_matching.py` | æ ‡å‡†åŒ¹é…å¤±è´¥ | `match_standard_clause` | skip/retry |
| `test_error_reflection_8_recommendation.py` | æ¨èç”Ÿæˆé”™è¯¯ | `generate_installation_reco` | retry/skip |

## ä½¿ç”¨æ–¹æ³•

### 1. è¿è¡Œå•ä¸ªæµ‹è¯•

```bash
# è¿è¡Œæ–‡ä»¶ä¸å­˜åœ¨é”™è¯¯æµ‹è¯•
python test_error_reflection_1_file_not_found.py

# è¿è¡Œæ–‡ä»¶æ ¼å¼é”™è¯¯æµ‹è¯•
python test_error_reflection_2_file_format.py

# ä»¥æ­¤ç±»æ¨...
```

### 2. æ‰¹é‡è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰8ä¸ªæµ‹è¯•
python run_all_error_reflection_tests.py
```

## æµ‹è¯•è¾“å‡ºè¯´æ˜

æ¯ä¸ªæµ‹è¯•éƒ½ä¼šè¾“å‡ºä»¥ä¸‹ä¿¡æ¯ï¼š

1. **é”™è¯¯åœºæ™¯æè¿°** - å½“å‰æµ‹è¯•çš„é”™è¯¯ç±»å‹
2. **é”™è¯¯è¯¦æƒ…** - å…·ä½“çš„é”™è¯¯ä¿¡æ¯å’ŒçŠ¶æ€
3. **LLMåæ€åˆ†æ** - AIå¯¹é”™è¯¯çš„ç†è§£å’Œåˆ†æ
4. **å†³ç­–ç»“æœ** - retry/skip/terminate ä¸‰ç§å†³ç­–ä¹‹ä¸€
5. **å†³ç­–åˆ†æ** - å¯¹AIå†³ç­–åˆç†æ€§çš„è¯„ä¼°

### ç¤ºä¾‹è¾“å‡º

```
ğŸ§ª é”™è¯¯åæ€æµ‹è¯• 1: æ–‡ä»¶ä¸å­˜åœ¨é”™è¯¯
==================================================
ğŸ“ æµ‹è¯•æ–‡ä»¶è·¯å¾„: /path/to/nonexistent/file.xlsx
âŒ é”™è¯¯æ¥æºèŠ‚ç‚¹: enter_upload_file
ğŸ’¬ é”™è¯¯ä¿¡æ¯: æ–‡ä»¶ä¸å­˜åœ¨: /path/to/nonexistent/file.xlsx
ğŸ”¢ å½“å‰é‡è¯•æ¬¡æ•°: 0

ğŸ¤– å¯åŠ¨LLMé”™è¯¯åæ€åˆ†æ...
------------------------------
ğŸ’­ AIåæ€ï¼šå—¯ï¼Œçœ‹èµ·æ¥ç”¨æˆ·é‡åˆ°äº†æ–‡ä»¶ä¸å­˜åœ¨çš„é”™è¯¯ï¼Œæˆ‘åº”è¯¥åˆ†æè¿™æ˜¯ä¸´æ—¶é—®é¢˜è¿˜æ˜¯çœŸæ­£çš„æ–‡ä»¶ç¼ºå¤±...
ğŸ¯ AIå†³ç­–ï¼šterminate - æ–‡ä»¶ç¡®å®ä¸å­˜åœ¨ï¼Œæ— æ³•ç»§ç»­å¤„ç†
ğŸ”„ é‡è¯•æ ‡å¿—: æ— 
â­ï¸ è·³è¿‡æ ‡å¿—: False
âŒ é”™è¯¯çŠ¶æ€: True

ğŸ“ å†³ç­–åˆ†æ:
ğŸ›‘ LLMå†³å®šç»ˆæ­¢ - åˆç†ï¼Œæ–‡ä»¶ä¸å­˜åœ¨æ— æ³•ç»§ç»­
```

## LLMå†³ç­–ç±»å‹

- **retry** - é‡è¯•å½“å‰èŠ‚ç‚¹ï¼Œé€‚ç”¨äºä¸´æ—¶æ€§é”™è¯¯
- **skip** - è·³è¿‡å½“å‰æ­¥éª¤ï¼Œç»§ç»­åç»­æµç¨‹
- **terminate** - ç»ˆæ­¢æ•´ä¸ªæµç¨‹ï¼Œé€‚ç”¨äºä¸¥é‡é”™è¯¯

## ç¯å¢ƒè¦æ±‚

- Python 3.8+
- å·²é…ç½®çš„ OpenAI API æˆ–å…¼å®¹æ¥å£
- æ™ºèƒ½ä½“é¡¹ç›®çš„å®Œæ•´ç¯å¢ƒ

## æ³¨æ„äº‹é¡¹

1. æµ‹è¯•ä¼šè‡ªåŠ¨åˆ›å»ºå’Œæ¸…ç†ä¸´æ—¶æ–‡ä»¶
2. æ¯ä¸ªæµ‹è¯•éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå¯ä»¥å•ç‹¬è¿è¡Œ
3. æµ‹è¯•ä¸ä¼šå½±å“å®é™…çš„æ™ºèƒ½ä½“è¿è¡Œ
4. å»ºè®®å…ˆè¿è¡Œå•ä¸ªæµ‹è¯•ç¡®è®¤ç¯å¢ƒæ­£å¸¸

## æ•…éšœæ’é™¤

å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼š

1. **ç¯å¢ƒé…ç½®** - ç¡®ä¿ conda ç¯å¢ƒå·²æ¿€æ´»
2. **API é…ç½®** - æ£€æŸ¥ OpenAI API å¯†é’¥æ˜¯å¦æœ‰æ•ˆ
3. **ä¾èµ–åŒ…** - ç¡®ä¿æ‰€æœ‰å¿…è¦çš„åŒ…éƒ½å·²å®‰è£…
4. **è·¯å¾„é—®é¢˜** - ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œæµ‹è¯•

## è´¡çŒ®

å¦‚éœ€æ·»åŠ æ–°çš„é”™è¯¯åœºæ™¯æµ‹è¯•ï¼š

1. åˆ›å»ºæ–°çš„æµ‹è¯•æ–‡ä»¶ï¼Œå‘½åæ ¼å¼ï¼š`test_error_reflection_N_scenario.py`
2. å®ç°æµ‹è¯•å‡½æ•°ï¼Œè¿”å›æ™ºèƒ½ä½“çŠ¶æ€
3. åœ¨æ‰¹é‡è¿è¡Œè„šæœ¬ä¸­æ·»åŠ æ–°æµ‹è¯•çš„æ˜ å°„
4. æ›´æ–°æœ¬è¯´æ˜æ–‡æ¡£ 