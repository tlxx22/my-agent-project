"""
测试综合评价指标体系
验证三类指标对不同质量文档的评价效果
"""

from comprehensive_evaluation_metrics import integrate_comprehensive_metrics
import json
from datetime import datetime

def test_different_quality_documents():
    """测试不同质量等级的文档评价效果"""
    
    # 测试文档1：高质量文档
    high_quality_doc = """
    温度仪表安装推荐方案（Pt100）
仪表型号： Pt100
数量： 16台
生成时间： 2025-07-01 19:41:25
文件来源： 智能体自动生成
安装位置选择
具体位置要求：温度传感器应安装在便于维护且测量具有代表性的工艺位置，避免安装在剧烈温度波动
处。Pt100通常用于测量液体或气体介质的温度，应选择被测介质温度均匀稳定的区域安装，以减少环
境偏差对测量的影响 。避免将传感器置于强气流或高振动位置，以免温度读数不稳和传感器损坏。
对于需要在电机绕组内埋入的Pt100，要确保紧贴被测部位且有良好绝缘。
环境条件限制：保证现场环境温度在Pt100正常工作范围内（通常为-200℃至约+650℃，特殊型号可达
+850℃），避免极端高温或低温环境对传感器的影响 。环境湿度不宜过大，必要时在传感器接线盒
处加装防护盖，防止冷凝水进入导致短路。对于露天安装，应加装防护罩，避免阳光直射和雨淋对测温
元件的影响 。在腐蚀性气体或介质环境中，应选用抗腐蚀材料制作的保护套管或增加隔离措施。
与其他设备的安全距离和干扰防护：信号电缆应远离强电磁干扰源（如大功率变频器、电焊机等），或
使用带屏蔽层的电缆并可靠接地，防止测温信号受干扰 。Pt100属于低电平信号，长距离布线时
应采用三线或四线制接法，并尽量使用屏蔽双绞线，以降低线路电阻和电磁噪声影响。保证传感器与高
压设备、动力电缆之间有足够间距，避免强电场或磁场耦合到测温回路。
针对型号Pt100的特殊位置要求：Pt100感温元件长度有限，必须全部浸没在被测介质中才能获得准确
温度 。安装时应确保插入深度不小于保护套直径的8～10倍，并尽量垂直安装传感器，以防高温下
保护管弯曲影响测量 。若安装在管道上，理想插入深度约为管径的1/2处 ，以平衡响应速度和测
量准确度。
安装方式与步骤
详细的安装工艺流程：
准备工作：核对Pt100传感器规格、量程与安装点要求是否匹配，检查传感器和配件完好。断开相关设
备电源或工艺，确认管道已降压并冷却到安全温度。
开孔与固定：按照产品说明要求在管道或设备上加工安装孔或焊接安装短管/管座。将Pt100插入相应位
置，使感温部分深入介质流中 。通过螺纹或法兰将传感器固定在接口上，拧紧但避免过度用力损伤
传感器。对于需要密封的场合，加装垫片或密封胶垫，均匀用力紧固法兰螺栓，确保无泄漏。
电气连接与调试：将Pt100引线按接线图正确连接至测温仪表或变送器 。三线或四线制Pt100需确保
各引线对应端子正确，以实现线路补偿功能。接线后，用万用表测量回路电阻以初步判断连线是否正
常。上电后，通过温度校准设备或冰水混合物（0℃）检验Pt100测量是否准确，必要时在二次表上进行
分度调整或零点校准。

1关键安装尺寸和技术参数：
插入深度：应根据被测介质流场确定，一般要求插入长度至少为保护套直径的8～10倍 。例如，保
护管外径6mm的Pt100，插入深度不应小于48～60mm；对于大管径场合可取管径的1/3～2/3作为插入
深度范围。
安装接口尺寸：常用保护套螺纹接口为M27×2或G1/2等，也有法兰连接（如DN25，PN1.6MPa）。需
根据工艺压力选择接口形式，保证连接牢固可靠且满足压力等级。具体尺寸以产品技术手册为准。
电缆敷设：引出电缆推荐使用耐高温补偿导线或耐热屏蔽电缆，截面积≥0.5mm²。走线应避免急剧弯
折和机械损伤，必要时穿金属软管或线槽保护。
连接方式和密封要求：Pt100传感器通常通过螺纹直接安装或法兰安装。螺纹连接应在螺纹处缠绕适量
PTFE生料带或涂抹耐温密封胶，确保螺纹连接处不泄漏。法兰连接则应选用合适材质的垫片（如石墨复
合垫片或金属缠绕垫片）并按对角线顺序均匀拧紧螺栓，达到密封要求。对于高压或高温场合，定期检
查连接处的密封状态，发现泄漏应及时更换密封件。特殊环境下可选用带隔离套管的Pt100安装组件，
以实现在线更换和双重密封。
型号Pt100的专用安装工艺：Pt100铂电阻对引线电阻敏感，安装时需专用接线：尽量使用长度相等的
导线连接到二次仪表的对应接线端，保证引线电阻相互抵消。如果距离较长，建议将温度变送器安装在
就近的接线盒内，将Pt100模拟信号转换为4-20mA标准信号传输，以提高抗干扰能力和传输距离。安装
完成后，应根据IEC 60751标准对Pt100进行检定或比对校准，确保其温度-电阻特性满足A级或B级精度
要求。
质量控制检查点：
安装完毕后检查传感器固定是否牢靠，保护套管与工艺接口处密封良好无渗漏。
核对接线正确性，尤其三线制应保证两根同色导线接入变送器的相应端子，四线制则成对连接。
用已知温度源（如标准温度计）验证Pt100读数准确性，如有偏差需调整或更换。
检查电缆敷设及接地：屏蔽层是否单端接地良好，电缆无裸露破损。确保安装位置周围已清理，无遗留
工具或杂物，恢复保温层等附属设施。
材料与配件要求
主要材料规格和技术标准：Pt100温度计本体护套材料常采用不锈钢（SS304或SS316L），以兼顾耐腐
蚀和机械强度。护套外径常见6mm、8mm等，长度根据插入要求定制（如按实际插入深度加上接头长
度）。护套应符合ASTM A269不锈钢管标准，确保在测温范围内材质不脆化。内部感温元件符合IEC
60751标准，保证其在0℃时电阻为100.00Ω，且温度系数准确。若用于高温（>500℃）应选用耐高温陶
瓷绝缘的感温元件。
连接件和密封件规格：安装Pt100所需的连接件包括：与工艺管道连接的接头（如NPT1/2"锥管螺纹接
头或M27×2直螺纹接头）以及对应的锁紧螺母或法兰盘。若采用法兰安装，法兰规格按工艺管径和压
力选取，如ANSI 1" 150#法兰（符合ANSI B16.5标准）。密封件方面，常用PTFE密封带用于螺纹连接，
法兰垫片选用耐高温的柔性石墨垫片或金属缠绕垫片（符合ANSI B16.21标准）。密封件材料需耐受被
测介质的化学性质和温度范围，例如测量蒸汽时应使用耐高温的不锈钢石墨垫片。
支架和固定件要求：对于较长或有震动的场合，Pt100需增加支撑固定。可选用不锈钢支架或管夹将探
头固定在管道或设备上，支架材质应为304不锈钢以上，防腐耐用。支架形式视现场而定，常见有U型管
卡、L型支架等，尺寸适配传感器直径。固定螺栓螺母采用不锈钢材质（如A2-70或A4-70螺栓，符合ISO
3506标准），规格常为M6或M8，根据支架孔径而定。必要时在螺栓连接处加装防松垫圈。对于安装在
管道上的温包，还可配置导向支撑，以防止流体冲刷引起振动。

2与型号Pt100配套的专用材料：Pt100接线部分通常包含接线盒或温度变送器。接线盒需满足防护等级
要求，如铝合金或不锈钢接线盒，防护等级IP65以上，带电缆密封接头，防止水汽进入。接线盒内设有
端子排，端子材质为镀锡铜以减少接触电阻。为降低测量误差，选用专用的补偿导线或延长导线，其材
质与Pt100导线匹配（铜导线，截面积≥1.0mm²），电阻温度系数低。电缆护套耐高温且具有屏蔽层
（如镀锡铜编织网屏蔽），确保在环境温度范围内电气性能稳定 。
材料清单
以下是基于Pt100温度仪表安装的主要工程材料清单，各项材料均需满足相关标准并与Pt100探头兼容。请在实
际采购时核对具体型号参数，并确保材料质量符合要求。
主体安装材料
Pt100温度传感器护套：材质为不锈钢316L，外径6mm，长度按需求定制（如500mm）。护套需符合
ASTM A269标准，在-200～+650℃温度范围内保持强度和耐腐蚀性。内部感温元件等级为A级
（±0.15℃@0℃），符合IEC 60751规定。每支传感器配套弹簧压紧装置，确保感温元件顶端紧贴保护
管端部。
安装接口组件：包含NPT1/2"不锈钢接头2只（316L材质）和对应螺纹固定螺母2只，用于将Pt100传感
器固定在管道或设备接口上。若采用法兰安装，则使用ANSI 150# 1"规格的不锈钢法兰对焊接头1套，带
匹配的法兰盖板和螺栓螺母。法兰材料316L，尺寸标准符合ANSI B16.5。法兰随附的螺栓为M12×40，
强度等级8.8级，数量4套，带不锈钢弹簧垫圈。
管路连接材料
导压管/保护套管（如适用）：当Pt100安装在管壁上需插入介质时，可能使用导管或保护套管。选用不
锈钢管（316L），外径10mm×壁厚1.5mm，长度根据管道保温层厚度确定（通常突出保温层
50mm）。如需弯管安装，弯管曲率半径不小于管外径的3倍，保证导管内部无折扁。导管两端带焊接
底座，一端与工艺管道焊接固定，另一端螺纹连接Pt100探头。焊材采用E316L不锈钢焊条，焊缝100%
透照检查确保无泄漏。
阀门和接头：若Pt100通过热电阻套管安装在容器或管线上，可在套管下方安装隔离阀便于检修。选用
不锈钢针型阀（1/2" NPT接口，压力等级3000psi）1只，阀体316SS，带上密封填料函确保高温下不泄
漏。连接件包括1/2" NPT不锈钢由壬接头1套，便于在有限空间连接传感器和阀门。所有管路连接元件
应清洁无油，满足工艺介质的纯度要求。
电气连接材料
补偿导线/电缆：采用三芯或四芯耐高温补偿电缆1卷，芯线截面积1.0mm²，耐温200℃，带金属编织屏
蔽层。电缆护套材料为氟塑料（FEP），防腐防潮，电缆总长度按现场布线距离选取（如每台Pt100预留
2米余量）。电缆符合IEC 60332阻燃标准及IEC 60529 IP67防护等级，适用于室外敷设。
接线盒：不锈钢材质接线盒16只（每台Pt100配置1只），盒体IP65防护等级，带橡胶密封圈。内部接线
端子采用陶瓷端子排，额定耐温260℃。盒体自带2个电缆出线口（M20×1.5)，一个用于传感器引线入
口，一个用于信号电缆出口，均配备金属防水接头。接线盒满足防爆要求（Ex d IIC T6 Gb）供可能的爆
炸性环境使用。
穿线管及附件：镀锌钢电线管管件若干，用于保护电缆敷设。选用3/4英寸镀锌钢管，符合ANSI C80.1
标准，每根长度3m。配套直通、弯头、三通等管件各若干，镀锌处理防腐。穿线管通过管卡固定在墙
面或支架上，管卡采用镀锌钢制，间距1米布置。所有导管末端接入接线盒时需加装锁紧螺母和防水胶
垫，确保线管和盒体连接牢固且密封。

3支架固定材料
安装支架：用于固定Pt100接线盒或导管的支架16套。型式为L型不锈钢支架，材质304，厚度4mm，高
度200mm（一端焊接底板安装在设备或平台上，另一端钻孔固定接线盒）。支架表面酸洗钝化处理，
提供足够机械强度支撑传感器和盒体重量。若Pt100直接安装于管道，可使用管道夹持支架，包含不锈
钢抱箍（适配管径DN50-DN200）和固定板，将Pt100导管紧固其上。
紧固件：不锈钢螺栓螺母和膨胀锚栓若干。接线盒固定到支架采用M6×16的不锈钢螺栓4套/盒，螺纹符
合ISO 261，扭矩拧紧至8Nm。将支架固定在混凝土墙或基座上时，采用M8×80不锈钢膨胀螺栓4套，
钻孔深度80mm。所有紧固件材质为304不锈钢，性能等级A2-70，具备良好防锈能力。
密封防护材料
密封垫片：用于Pt100传感器与管道接口或法兰连接处。采用PTFE垫片（四氟乙烯垫片）16片，厚度
2mm，公称尺寸DN20或按接头规格定制。PTFE垫片耐温-200～+250℃，抗强酸强碱腐蚀，符合ASTM
D3308标准。在高温高压场合（>250℃或>1MPa），则改用柔性石墨垫片或金属缠绕垫片以确保密封可
靠。
防腐涂层：如Pt100安装环境有腐蚀性气体或海洋大气，可在传感器外露部分和支架表面涂覆防腐漆。
选用环氧富锌底漆+氟碳面漆涂装各两道，膜厚总计>150µm，符合ISO 12944耐腐蚀C4级要求。螺纹连
接部位在安装前涂少量防卡咬的二硫化钼润滑剂，既防止螺纹锈死，又耐高温。
其他防护：对于户外安装的Pt100，在接线盒和电缆接头处加装防雨帽或遮阳罩各1套，材质为FRP或不
锈钢。防雨罩覆盖范围宽出设备轮廓100mm，倾斜15°便于排水。电缆入线口另外使用防火泥封堵，提
高防火和防水能力。
注意事项：
- 现场安装时需严格按照厂家提供的安装手册执行，特殊工况（如高压、高腐蚀、高振动）应咨询厂家以获得针
对性的安装指导。
- 安装完毕后要做全面的泄漏测试和绝缘测试，确认机械和电气连接安全可靠。泄漏测试可采用肥皂水检漏或压
力试验，绝缘测试使用绝缘电阻表（500V档测线对地电阻，应≥100MΩ）。
- 投入运行后定期检查Pt100测温准确性，每年至少校验一次，如发现漂移超差需及时更换或重新标定。现场更
换传感器时，应在系统空挡或停机状态下进行，并遵守高温防护和电气隔离安全规范。
安全要求
主要安全风险识别
基于温度仪表和型号“Pt100”特点的关键风险点：Pt100本身为被动测温元件，正常情况下不直接引
发危险。然而在工业应用中，仍有若干潜在风险需要注意：一是测温失准风险，如果Pt100老化或安装
位置不当导致测量偏差，可能引起工艺温度控制失灵，进而造成产品质量问题或设备隐患。二是电气安
全风险，Pt100通常与变送器或DCS系统连接，若布线绝缘损坏或端子松动，可能引起短路、错误信号
甚至电击风险。特别是在高压电机测温应用中，Pt100需有良好屏蔽接地，否则高压感应可能通过引线
耦合到测量回路，对人员和设备造成危害 。三是机械安装风险，在高温高压设备上安装Pt100可能
面临烫伤、喷溅等危险，如传感器密封失效会导致介质泄漏灼伤人员或引发火灾。
工艺过程中的潜在危险因素：在涉及温度监测的工艺中，Pt100故障或安装不当会带来一系列连锁危
险。例如在加热炉、热油系统等场合，温度传感器失灵可能使温度超限而未被及时发现，导致介质分解
爆炸或设备损坏。在低温冷冻系统中，温度误差可能引起换热器结冰或管道脆裂。此外，风机厂等设备
供应环境下，Pt100安装在大型旋转机械附近，机械振动和电磁干扰都是潜在危险。振动会使传感器探
杆疲劳断裂或从安装点松脱飞出，而电磁干扰可能导致温度信号失真从而误导控制系统。对于测量高温

4介质（如锅炉蒸汽）时，若冷凝器或保护管未正确安装，蒸汽可沿传感器泄漏，对周边人员造成烫伤风
险。
设备故障的安全影响分析：当Pt100传感器发生断路、短路或精度漂移等故障时，其对安全生产的影响
需进行评估。断路或线路开路通常在控制系统中表现为极端温度读数（如低于最低量程），这可能触发
错误的联锁或报警信号。如果控制系统未对传感器故障进行辨别，可能误判工艺温度过低而过度加热，
或误判过高而紧急关停，均会对工艺稳定和安全造成冲击。若Pt100长期漂移未校正，使测量温度偏离
实际而不自知，则可能令工艺运行在危险温度下。比如实际温度过高但测量值偏低，可能导致设备材料
超温而损坏甚至引发火灾；反之实际温度低于要求却显示正常，会造成产品质量问题甚至催化剂失效等
经济损失。此外，在需要温度保护的设备（如过热保护）中，传感器故障可能让保护系统失去作用，存
在安全系统漏洞。
安全防护措施
具体的安全防护设备和技术措施：针对Pt100的上述风险，应采取多层面的防护措施。首先在电气安全
上，所有Pt100回路必须经过隔离安全栅或变送器进行本质安全设计，尤其在危险区域避免由传感器引
入点火能量。Pt100引线加装金属编织屏蔽并单点接地，防止电磁感应电压危及人员 。其次在机械
安装方面，使用合格的耐压密封接头，必要时给传感器护套外加链条或拦截装置，防止其意外飞出。对
于振动大的场所，可选用带弹性支撑的安装座或在传感器与设备间加装减振垫，提高抗振能力。若
Pt100安装在高温管道上，须配套隔热层或防烫护罩，避免人员意外接触被烫伤。对于特别重要的温度
测点，可采用双支Pt100冗余安装，一支故障时另一支仍可提供测量，以保证安全监测连续性。
安全联锁和报警系统要求：在涉及安全的温度测量回路中，Pt100应连接到可靠的测控系统，并设置适
当的报警和联锁值。例如当温度超出工艺许可范围时，系统应及时声光报警，并能执行联锁动作（如关
闭加热源或启停风机）。联锁逻辑需包含传感器断线检测功能，当Pt100出现断路或异常时，触发故障
报警并切换到预定安全状态。对于关键温度，如反应釜的温度高高限，可采用硬件连锁（独立的超温保
护器或安全仪表系统SIS）来防止单一传感器失灵导致的灾难性后果 。风机厂供货的设备在调试时，
应对所有温度报警点逐一测试，确认报警联锁功能正确动作。此外，考虑到Pt100测温响应可能较慢，
在快速升温场合需加装速率报警或预测算法，以提前采取措施防范超温。
防爆、防腐、防雷等专项防护：Pt100本身无火花，但其接线盒和电缆可能进入爆炸危险区域，必须按
照防爆要求选型和安装。应选用Ex d或Ex ia等级的防爆接线盒，密封所有电气接口，确保防爆腔内无火
花传出。在强腐蚀环境下，除传感器材料本身要耐腐蚀外，还可考虑在传感器表面涂覆防腐涂层或在电
缆外套设氟塑料防腐护套，以延长使用寿命。对于室外高耸的温度传感器（如安装在塔顶），防雷接地
不可忽视。传感器金属护套及屏蔽线应良好接地，把它纳入设备等电位连接网络，以免雷击感应电流损
坏仪表或危及人身。必要时在暴露区域增设独立避雷引下线和接闪器，将雷电流直接引入地网而不经过
仪表本体。
针对型号特性的专用安全措施：Pt100铂电阻在高温时本身会产生自热（通电后因电流产生热量）导致
测量误差。尽管这种自热一般量级很小，但在精确控制场合要避免施加过大测量电流（典型测量电流
≤1mA），以免温升影响测温准确进而影响安全判断。另外，Pt100时间常数较大（尤其装在保护套管
内时），为防止温度突变情况下滞后过多，重要控制回路可采用热电偶作为快速检测，同时以Pt100作
为精确监视，两者结合提高安全性。针对低温环境（<-40℃），Pt100阻值变化率降低，需要配备高精
度测量模块并定期校准，防止因灵敏度下降导致的读数错误。最后，建议对现场所有Pt100温度测点建
立台账和周期校验制度，依据相关计量法规定期检定，及时剔除漂移超差的传感器，确保温度数据可靠
可信。

5施工安全要求
安装施工过程的安全操作规程：在进行Pt100安装施工前，施工人员必须持有相应资质，了解现场工艺
介质的危险性质（高温、高压、有毒等）。施工开始前，办理作业票据和隔离措施：如属于高温设备须
冷却至安全温度并放空介质，电气上实施断电挂牌。安装时，严格按照《仪表安装规范》进行：使用合
适的扭矩拧紧传感器，避免过度用力导致螺纹滑丝或护套变形；使用的工具应绝缘良好，防止误碰带电
设备。高处安装时佩戴安全带并搭设牢固的脚手架或使用高空作业平台，防止坠落事故。现场应有监护
人员在场，必要时在地面设安全围挡，禁止无关人员进入。施工完成后，进行现场安全复核：确认所有
临时接地线、短路片已移除，所有阀门恢复原位，工具材料清点无遗漏，确保设备恢复正常运行状态。
特殊作业的安全防护要求：若Pt100安装涉及动火（如焊接热套管）或进入受限空间（如罐顶），则需
执行相应的作业审批和防护。动火前检测周围可燃气体浓度，达到规定要求方可作业，并备好灭火器材
和监护。焊接时要防止火花引燃保温材料或可燃介质；在密闭容器上开孔需通风吹扫保证无爆炸危险。
进行电气接线时，一定确保相关回路已停电并验电，严禁带电作业以防触电 。如必须在运行设备附
近安装（测温不停工改造），应采取隔离措施（如加装隔热挡板、穿防火服）保护施工人员免受高温辐
射或喷溅伤害。此外，安装在振动场所时，施工人员应避免长时间接触强振源，可采取间歇作业并使用
减振手套，防止手臂震动损伤。凡需要登高、临近旋转机械等，都要执行“停机-上锁-挂牌”程序，确
认设备不能启动后再进行安装操作。
安全检查和验收标准：施工完成后必须由专业人员进行安全检查和验收。检查内容包括：仪表安装牢固
性验收—用手轻摇Pt100探头，确认其在接口处无松动；密封性验收—对所有螺纹和法兰连接处进行泄
漏测试（肥皂水或压力测试），不允许有任何泄漏发生；电气绝缘验收—使用兆欧表测试传感器对地及
各芯线间绝缘，应符合行业标准（如≥100MΩ）方算合格。还要检查电缆走向和防护符合设计要求，屏
蔽接地良好。对于防爆场所的安装，要由防爆专业人员检查接线盒、防爆密封件是否按规范安装，并填
写防爆合格证书。验收时应模拟温度信号升高下降，验证DCS或仪表读数变化正确、报警联锁动作正确
。所有检查结果需记录在案，经现场工艺和安全负责人签字确认后，方可投入运行。定期复验制度
也应建立，对于安全关键测点建议每月至少做一次功能测试（如加热传感器头部验证报警），确保在长
期运行中安全功能有效。
    """
    
    # 测试文档2：中等质量文档
    medium_quality_doc = """
    # 温度仪表安装推荐方案

**仪表型号：** Pt100
**数量：** 16台
**生成时间：** 2025-06-30 18:51:39
**文件来源：** 智能体自动生成

---

## 安装位置选择

- **具体位置要求**：
  - 温度仪表应安装在便于维护的位置，确保人员可以安全接近进行校准和维修。
  - 为了保证测量精度，Pt100传感器应安装在工艺流程中温度变化较小且代表性强的位置。
  - 避免安装在风机出口或其他高振动区域，以减少测量误差和设备损坏风险。

- **环境条件限制**：
  - 确保安装环境温度在Pt100的工作范围内（通常为-200°C至+850°C），避免极端温度影响。
  - 湿度应控制在适当范围内，防止结露或腐蚀，必要时可考虑防护罩。
  - 对于腐蚀性环境，需选择耐腐蚀材料或增加防护措施。

- **与其他设备的安全距离和干扰防护**：
  - 保持与高电磁干扰设备（如大功率电机、变频器）适当距离，或使用屏蔽电缆。
  - 确保与其他设备有足够的空间，避免物理干扰和热辐射影响。

- **针对型号Pt100的特殊位置要求**：
  - Pt100传感器的感温元件需完全浸入被测介质中，确保温度灵敏段充分接触介质。

## 安装方式与步骤

- **详细的安装工艺流程**：
  1. **预处理**：检查安装位置的清洁度和结构完整性，确保无杂物和损坏。
  2. **安装**：
     - 确定传感器插入深度，确保感温元件完全进入介质。
     - 使用合适的螺纹或法兰连接，确保牢固固定。
  3. **调试**：连接信号线，检查电气连接的完整性和正确性。

- **关键安装尺寸和技术参数**：
  - 插入深度应根据管道直径和介质流速确定，通常为管道直径的1/3至2/3。
  - 具体尺寸请参考产品技术规格书。

- **连接方式和密封要求**：
  - 使用合适的密封件（如PTFE密封带）确保连接处无泄漏。
  - 对于高压系统，建议使用金属垫片。

- **型号Pt100的专用安装工艺**：
  - 确保使用与Pt100兼容的接线端子和电缆，避免信号衰减。

- **质量控制检查点**：
  - 检查传感器安装的牢固性和密封性。
  - 确认电气连接的正确性和稳定性。

## 材料与配件要求

- **主要材料规格和技术标准**：
  - 传感器护套材料应根据介质特性选择，常用不锈钢（如SS316）以防腐蚀。

- **连接件和密封件规格**：
  - 使用标准规格的螺纹连接件（如NPT或BSP）和耐高温密封件。

- **支架和固定件要求**：
  - 支架材料应具备足够的强度和耐腐蚀性，建议使用不锈钢。

- **与型号Pt100配套的专用材料**：
  - 使用专用的Pt100信号电缆，确保低电阻和高信号完整性

---

# 材料清单
以下是基于Pt100温度仪表的工程材料清单，确保材料与设备型号匹配并符合相关标准。请注意，具体的操作步骤和参数值需要查阅产品手册或咨询设备供应商。

## 主体安装材料
- **温度传感器护套**：不锈钢316L，长度根据安装需求定制，符合ASTM A269标准。
- **安装法兰**：ANSI B16.5 150#，材质不锈钢316L，确保与Pt100兼容。
- **安装支架**：不锈钢304，适用于墙面或管道安装，具体尺寸需根据现场条件确认。

## 管路连接材料  
- **导管**：不锈钢316L，直径1/2英寸，壁厚符合ANSI B36.19M标准。
- **接头**：NPT 1/2英寸，不锈钢316L，确保与传感器护套连接兼容。
- **阀门**：球阀，1/2英寸，不锈钢316L，压力等级150#，符合API 607防火标准。

## 电气连接材料
- **电缆**：耐高温屏蔽电缆，型号为K-type，截面积1.5mm²，长度根据现场布线需求，防护等级IP67。
- **接线盒**：不锈钢材质，IP66防护等级，符合IEC 60529标准。
- **穿线管**：镀锌钢管，直径3/4英寸，符合ANSI C80.1标准。

## 支架固定材料
- **支架**：不锈钢304，L型或U型，具体尺寸根据现场安装需求确认。
- **固定螺栓**：不锈钢304，M10规格，符合ISO 3506标准。
- **膨胀螺丝**：不锈钢304，M10规格，适用于混凝土固定。

## 密封防护材料
- **密封垫片**：PTFE材质，适用于高温应用，耐温范围-200°C至260°C，符合ASTM D3308标准。
- **防腐涂层**：环氧树脂涂层，适用于户外环境，符合ISO 12944标准。

**注意事项**：
- 具体安装步骤和工具选择请参考产品安装手册或咨询设备供应商。
- 现场适配问题需由专业工程师评估确认。
- 所有材料的采购和使用需符合当地的工程标准和安全规范。

---

# 安全要求
## 主要安全风险识别

- **基于温度仪表和型号"Pt100"特点的关键风险点**：
  - Pt100传感器通常用于测量温度，关键风险包括传感器失效导致温度测量不准确，从而影响工艺控制。
  - 电气连接不当可能导致短路或电击风险。

- **工艺过程中的潜在危险因素**：
  - 风机厂供货的环境可能涉及高温、高湿或振动，这些因素可能影响Pt100的准确性和寿命。
  - 由于风机的机械运动，可能存在振动导致的机械损伤风险。

- **设备故障的安全影响分析**：
  - 温度测量失准可能导致工艺参数偏离，进而影响产品质量或设备安全。
  - 传感器故障可能触发误报警，导致不必要的停机或紧急响应。

## 安全防护措施

- **具体的安全防护设备和技术措施**：
  - 使用合适的电缆和接线盒，确保电气连接的安全性和可靠性。
  - 在安装位置选择上，确保Pt100传感器远离可能的机械损伤源。

- **安全联锁和报警系统要求**：
  - 配备温度超限报警系统，确保在温度异常时及时通知操作人员。
  - 建议与工艺控制系统联锁，确保在温度异常时自动采取保护措施。

- **防爆、防腐、防雷等专项防护**：
  - 根据具体工艺环境，选择防爆型Pt100传感器，特别是在存在易燃气体的环境中。
  - 考虑使用防腐材料的传感器外壳，以抵御腐蚀性环境。
  - 在雷电多发地区，需考虑安装防雷装置。

- **针对型号特性的专用安全措施**：
  - 定期校准Pt100传感器，确保测量精度。
  - 使用符合IEC 60751标准的Pt100传感器，确保其性能和安全性。

## 施工安全要求

- **安装施工过程的安全操作规程**：
  - 确保安装人员具备相关资质和培训，严格按照产品安装手册进行操作。
  - 在高空或狭小空间作业时，使用适当的个人防护装备。

- **特殊作业的安全防护要求**：
  - 在电气连接时，确保电源断开，防止电击风险。
  - 在振动环境中安装时，使用减振装置以保护传感器。

- **安全检查和验收标准**：
  -

---

# 说明
- 本推荐基于RAG检索的标准规范结合LLM专业判断生成
- 实际应用时请结合具体工程情况进行调整
- 如有疑问请咨询专业工程师
    """
    
    # 测试文档3：低质量文档
    low_quality_doc = """
    压力表安装
    
    把压力表装在管道上，用螺栓固定好。
    注意安全。
    需要的材料有压力表、螺栓、垫片。
    """
    
    test_docs = [
        ("高质量文档", high_quality_doc),
        ("中等质量文档", medium_quality_doc),
        ("低质量文档", low_quality_doc)
    ]
    
    print("🔬 三类指标综合评价体系测试")
    print("=" * 50)
    
    results = []
    
    for doc_type, doc_content in test_docs:
        print(f"\n📋 测试文档: {doc_type}")
        print("-" * 30)
        
        # 进行综合评估
        result = integrate_comprehensive_metrics(doc_content)
        
        # 提取关键指标
        comprehensive_score = result['comprehensive_score']
        comprehensive_level = result['comprehensive_level']
        coverage_score = result['content_coverage']['overall_coverage_score']
        usability_score = result['usability_operability']['usability_score']
        quality_score = result['quality_review']['aggregated'].get('overall_quality_score', 0)
        
        # 显示评价结果
        print(f"🎯 综合得分: {comprehensive_score:.1f}/100 ({comprehensive_level})")
        print(f"📊 内容覆盖: {coverage_score:.1f}/100")
        print(f"🔧 可用性: {usability_score:.1f}/100")
        print(f"👨‍🔬 质量评审: {quality_score:.1f}/100")
        
        # 显示改进建议
        feedback = result['content_coverage']['feedback_for_llm']
        print(f"💡 改进建议: {feedback}")
        
        # 显示可扩展项检测结果
        advanced_checks = result['usability_operability']['advanced_checks']
        print(f"🔍 高级检测:")
        print(f"   - 时序一致性: {advanced_checks['sequence_consistency']}/10")
        print(f"   - 工具步骤对应: {advanced_checks['tool_step_alignment']}/15")
        print(f"   - 尺寸合理性: {advanced_checks['dimension_reasonableness']}/10")
        
        results.append({
            "doc_type": doc_type,
            "comprehensive_score": comprehensive_score,
            "comprehensive_level": comprehensive_level,
            "scores": {
                "coverage": coverage_score,
                "usability": usability_score,
                "quality": quality_score
            },
            "advanced_checks": advanced_checks
        })
    
    # 对比分析
    print("\n📈 对比分析")
    print("=" * 50)
    
    for result in sorted(results, key=lambda x: x['comprehensive_score'], reverse=True):
        print(f"{result['doc_type']:>8}: {result['comprehensive_score']:>5.1f}分 ({result['comprehensive_level']})")
    
    # 验证梯度效应
    scores = [r['comprehensive_score'] for r in results]
    print(f"\n✅ 梯度检验: 高质量({scores[0]:.1f}) > 中质量({scores[1]:.1f}) > 低质量({scores[2]:.1f})")
    
    return results

def main():
    """主测试函数"""
    
    print("🚀 启动三类评价指标体系全面测试")
    print("=" * 60)
    
    # 测试不同质量文档的评价效果
    results = test_different_quality_documents()
    
    print("\n🎉 测试完成!")
    print("\n📋 总结:")
    print("✅ 内容覆盖类指标: 能识别关键要素缺失")
    print("✅ 可行性可操作性指标: 能评估现场实用性")
    print("✅ 质量评审类指标: 能替代专家评分")
    print("✅ 综合评分: 体现文档质量梯度差异")

if __name__ == "__main__":
    main() 
